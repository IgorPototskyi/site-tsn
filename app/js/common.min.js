$(function(){function e(e,t){var i,a,s,n=$(".slider__nav");e.forEach(function(e,o){i=$("#sliderSlideId").clone().removeAttr("id").removeAttr("style"),a=i.find(".slider__link").attr({href:e.link}),e.videoSrc?(i.find(".slider__video").removeAttr("style"),i.find(".slider__video-src").attr({src:e.videoSrc,type:e.videoType})):(a.css({"background-image":"url('"+e.imageUrl+"')"}),i.find(".slider__video").remove()),i.find(".slider__title").html(e.title),s=i.find(".slider__section").html(e.section),"ТСН День"===e.section&&s.addClass("slider__section--imp"),i.find(".slider__datetime").html(e.datetime),i.appendTo(t),$("<li>").addClass("slider__nav-item").attr({"data-link":o}).appendTo(n)},this),t.find("#sliderSlideId").remove()}function t(e){$slides=e.children(".slider__slide");var t=$(".slider__nav-item");$slides.hide(),$slides.eq(o).show(),t.eq(o).addClass("active")}function i(e,t){var i,a,s,n,o;e.forEach(function(e){switch(i=$("#newsItemId").clone().removeAttr("id").removeAttr("style"),a=i.find(".news__item-cont"),s=i.find(".news__item-views"),n=i.find(".news__item-comments"),o=i.find(".news__item-section"),i.find(".news__item-link").attr("href",e.link),i.find(".news__item-img").attr({src:e.imageUrl,alt:e.alt}),i.find(".news__item-title").text(e.title),e.videoSrc&&(a.addClass("news__item-cont--video"),$("<div>").addClass("news__item-shade").appendTo(a),$("<i>").addClass("fa fa-play-circle-o news__icon-play").appendTo(a),$("<i>").addClass("fa fa-share-square-o news__icon-share").appendTo(a)),s.html(s.html()+e.views),n.html(n.html()+e.comments),o.attr("href",e.sectionLink).html(e.section),e.section){case"Світ":o.addClass("section-world");break;case"Україна":o.addClass("section-ukr");break;case"Гламур":o.addClass("section-glam");break;case"Гроші":o.addClass("section-money")}i.find(".news__item-datetime").text(e.datetime),i.appendTo(t)},this),$(".news__video").css("left",d.position().left+20)}function a(e,t){var i;e.forEach(function(e,a){if(i=$("#photosItemId").clone().removeAttr("id").removeAttr("style").css({"background-image":"url("+e.photosUrl[0]+")","background-position":e.photoPosition}),"true"===e.doubleWidth&&i.addClass("photos__item--width2"),"true"===e.doubleHeight&&i.addClass("photos__item--height2"),"true"===e.doubleHeight||"true"===e.doubleWidth){var s=e.description;s.length>50&&(s=s.slice(0,51)+"..."),i.find(".photos__title").html(s)}else i.find(".photos__descr").remove();i.attr("data-pos",a).appendTo(t)},this)}function s(e,t){var i,a,s;e.forEach(function(e,n){"true"===e.banner?(s=$("#asideBannerId").clone().removeAttr("id").removeAttr("style"),s.find(".aside__banner-link").attr({href:e.link}),s.find(".aside__banner-img").attr({src:e.imageUrl,alt:e.alt}),s.appendTo(t)):(i=$("#asideItemId").clone().removeAttr("id").removeAttr("style"),a=i.find(".aside__link").attr("href",e.link),"true"===e.isImportant&&a.addClass("aside__link--imp"),e.imageUrl?(i.find(".aside__img").attr({src:e.imageUrl,alt:e.alt}),e.videoTime?i.find(".aside__video-time").html(e.videoTime):i.find(".aside__video").remove()):i.find(".aside__img-cont").remove(),i.find(".aside__item-title").html(e.title),i.find(".aside__datetime").html(e.datetime),i.appendTo(t))},this)}function n(){for(var e,t,i=$(".main-nav__list"),a=$(".aside"),s=$(".main-nav__sublist");i.outerWidth()+50>a.position().left;)e=i.children(),t=e.eq(e.length-2),t.removeClass().addClass("main-nav__subitem").prependTo(s),t.find(".main-nav__link").removeClass().addClass("main-nav__sublink")}!function(){TweenMax.to(".preloader__tsn",1,{backgroundColor:"#cc0000"})}();var o=0;!function(){var i=$(".slider");$.getJSON("json/slider.json",function(a){var s=a.slice();s.length&&(e(s,i),t(i))})}(),$("body").on("mouseenter",".slider__nav-item",function(e){var t=$(this).attr("data-link");if(t!=o){$(".slider__nav-item").eq(o).removeClass("active"),$(this).addClass("active"),$slides=$(".slider__slide"),$slides.eq(o).animate({height:"hide"}),$slides.eq(t).animate({height:"show"});var i=$slides.eq(t).find(".slider__video");i.length>0&&(i.get(0).currentTime=0),o=t}});var d=$(".top-nav"),l=$(".main-nav__list"),r=$(".social__link");$(window).scroll(function(){var e=$(document).scrollTop();0==e&&d.removeClass("top-nav--dark"),e>1&&e<400&&(d.removeClass("top-nav--light"),r.removeClass("social__link--dark"),d.addClass("top-nav--dark"),l.removeClass("main-nav__list--fixed")),e>400&&(r.addClass("social__link--dark"),d.removeClass("top-nav--dark"),d.addClass("top-nav--light"),l.addClass("main-nav__list--fixed"))});var _=$(".top-nav__search-btn"),c=$(".social");_.on("click",function(){c.hide(200),$(this).toggleClass("top-nav__search--big")}),$(".top-nav__share-btn").on("click",function(){_.removeClass("top-nav__search--big"),c.toggle(200)});var m=$(".news__nav-link");m.on("click",function(){m.removeClass("active"),$(this).addClass("active")}),function(){var e=$(".news__container");$.getJSON("json/news.json",function(t){var a=t.slice();a.length&&i(a,e)})}(),$("body").on("click",".news__icon-share",function(e){e.preventDefault();var t=$(".news__video"),i=$(".news__item-cont");return $(this).parent().hasClass("news__item-cont--shared")?(t.removeClass("active"),i.removeClass("news__item-cont--shared")):(t.removeClass("active"),i.removeClass("news__item-cont--shared"),$(this).parent().addClass("news__item-cont--shared"),t.children(".news__item-img").remove(),$(this).siblings(".news__item-img").clone().prependTo(t),t.addClass("active")),!1}),$("body").on("click",".news__video-close",function(e){$(".news__video").removeClass("active"),$(".news__item-cont").removeClass("news__item-cont--shared")});var v=[];!function(){var e=$(".photos__cont");$.getJSON("json/photos.json",function(t){v=t.slice(),v.length&&(a(v,e),e.masonry({itemSelector:".photos__item",gutter:".photos__gutter-sizer",columnWidth:".photos__item-sizer",percentPosition:!0}))})}(),$("body").on("click",".photos__open",function(){var e=$(this).parent().attr("data-pos"),t=v[e],i=$("body").scrollTop(),a=$("<div>").addClass("gallery").css("padding-top",i).appendTo(".photos");$("<h2>").addClass("gallery__title").html(t.description).appendTo(a);var s=$("<div>").addClass("fotorama gallery__cont").attr({"data-width":"616","data-height":"412","data-nav":"thumbs","data-thumbwidth":"90","data-thumbheight":"60","data-thumbborderwidth":"1","data-thumbbordercolor":"#fff","data-transition":"crossfade","data-auto":"false"}).appendTo(a);t.photosUrl.forEach(function(e){var t=$("<a>").addClass("gallery__link").attr("href",e).appendTo(s);$("<img>").addClass("gallery__img").attr("src",e).appendTo(t)},this),$("<i>").addClass("fa fa-times gallery__close").css("top",i+20).appendTo(a);$(".fotorama").fotorama()}),$("body").on("click",".gallery__close",function(){$(".gallery").remove()}),function(){var e=$(".aside__news");$.getJSON("json/aside.json",function(t){var i=t.slice();i.length&&s(i,e)})}(),n(),$(window).on("resize",n)}),$(window).on("load",function(){TweenMax.to($(".preloader__title"),1,{opacity:1}),TweenMax.to($(".preloader"),1,{opacity:0,delay:1}),TweenMax.to($(".preloader"),.1,{display:"none",delay:2})});